/*! jQuery UI Virtual Keyboard Typing Simulator v1.11.1 */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&"object"==typeof module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){e.fn.addTyping=function(t){var n={showTyping:!0,lockTypeIn:!1,delay:250,hoverDelay:250},i=e.keyboard;return this.each(function(){var p,s=e(this).data("keyboard");s&&(p=s.typing_options=e.extend({},n,t),s.typing_keymap={" ":"space",'"':"34","'":"39","&nbsp;":"space","\b":"bksp","{b}":"bksp","{d}":"del","{l}":"left","{r}":"right","\n":"enter","\r":"enter","{e}":"enter","\t":"tab","{t}":"tab"},s.typing_xref={8:"bksp",9:"tab",13:"enter",32:"space",37:"left",39:"right",46:"del"},s.typing_event=!1,s.typing_namespace=s.namespace+"typing",s.extensionNamespace.push(s.typing_namespace),p.savedLockInput=s.options.lockInput,s.typing_setup_reset=function(){var e=i.events,t=s.typing_namespace,n=[e.kbHidden,e.kbInactive,""].join(t+" ");s.$el.unbind(t).bind(n,function(){s.typing_reset()}),s.$allKeys.unbind(t).bind("mousedown"+t,function(){s.typing_reset()})},s.typing_setup=function(){var e=s.typing_namespace;s.typing_setup_reset(),s.$el.bind(i.events.kbBeforeVisible+e,function(){s.typing_setup()}),s.$preview.unbind(e).bind("keyup"+e,function(e){if(p.init&&p.lockTypeIn||!p.showTyping)return!1;if(!(e.which>=37&&e.which<=40))return 16===e.which&&(s.shiftActive=!1),18===e.which&&(s.altActive=!1),16===e.which||18===e.which?(s.showSet(),void setTimeout(function(){s.$preview.focus()},200)):void 0}).bind("keydown"+e,function(e){if(p.init&&p.lockTypeIn||!p.showTyping)return!1;e.temp=!1,16===e.which&&(e.temp=!s.shiftActive,s.shiftActive=!0),18===e.which&&(e.temp=!s.altActive,s.altActive=!0),e.temp&&(s.showSet(),s.$preview.focus()),s.typing_event=!0,s.typing_xref[e.which]&&s.typing_findKey("",e)}).bind("keypress"+e,function(e){if(p.init&&p.lockTypeIn)return!1;s.typing_event&&!s.options.lockInput&&(s.typing_reset(),s.typing_event=!0,s.typing_findKey("",e))})},s.typing_reset=function(){s.typing_event=p.init=!1,p.text="",p.len=p.current=0,s.options.lockInput=p.savedLockInput},s.typeIn=function(e,t,n,i){if(!s.isVisible())return clearTimeout(s.typing_timer),void s.typing_reset();if(s.typing_event){if(void 0===e)return s.typing_event=!1,void(s.options.lockInput=p.savedLockInput)}else!0!==p.init&&(p.init=!0,s.options.lockInput=p.lockTypeIn,p.text=e||p.text||"",p.len=p.text.length,p.delay=t||p.delay,p.current=0,n&&(p.callback=n)),"{"===(e=p.text.substring(p.current,++p.current))&&"}"===p.text.substring(p.current+1,p.current+2)&&(e+=p.text.substring(p.current,p.current+=2)),s.typing_findKey(e,i)},s.typing_findKey=function(t,n){var y,o,r,a,c,u,g,l,f=i.css,d=i.builtLayouts[s.layout].mappedKeys;if(s.isOpen&&s.$keyboard.length)if(u=s.$keyboard.find("."+f.keySet),a=t in s.typing_keymap?s.typing_keymap[t]:t,y="."+f.keyButton+'[data-action="'+a+'"]',s.typing_event&&n&&("keypress"!==n.type&&s.typing_xref.hasOwnProperty(n.keyCode||n.which)?y="."+f.keyPrefix+s.processName(s.typing_xref[n.keyCode||n.which]):(o=String.fromCharCode(n.charCode||n.which),y=d.hasOwnProperty(o)?"."+f.keyButton+'[data-value="'+d[o].replace(/"/g,'\\"')+'"]':"."+f.keyPrefix+s.processName(o))),c=u.filter(":visible").find(y),c.length?s.typing_simulateKey(c,t,n):(s.typing_event?c=u.find(y):(r=t in s.typing_keymap?s.typing_keymap[t]:s.processName(t),c=u.find("."+f.keyPrefix+r)),(l=c.closest("."+f.keySet)).attr("name")?(p.showTyping&&(g=l.attr("name"),s.shiftActive=/shift/.test(g),s.altActive=/alt/.test(g),s.metaActive=s.last.keyset[2]=!!/\bmeta/.test(g)&&g.match(/meta[\w-]+/)[0],s.showSet(s.metaActive)),s.typing_simulateKey(c,t,n)):s.typing_event||(t in s.typing_keymap&&s.typing_keymap[t]in i.keyaction?i.keyaction[s.typing_keymap[t]](s,c,n):s.insertText(t),s.checkCombos(),s.$el.trigger(i.events.kbChange,[s,s.el]))),p.current<=p.len&&0!==p.len){if(!s.isVisible())return;s.typing_timer=setTimeout(function(){s.typeIn()},p.delay)}else{if(0!==p.len)return s.typing_reset(),void(e.isFunction(p.callback)&&(s.typing_timer=setTimeout(function(){e.isFunction(p.callback)&&p.callback(s)},p.delay)));s.typing_reset()}},s.typing_simulateKey=function(t,n,y){var o=t.length;s.isVisible()&&(p.showTyping&&o&&(t.filter(":visible").trigger("mouseenter"+s.namespace),p.showTyping&&o&&setTimeout(function(){t.trigger("mouseleave"+s.namespace)},Math.min(p.hoverDelay,p.delay))),s.typing_event||setTimeout(function(){n in s.typing_keymap&&s.typing_keymap[n]in i.keyaction?((y=y||e.Event("keypress")).target=t,i.keyaction[s.typing_keymap[n]](s,t,y)):s.insertText(n),s.checkCombos(),s.$el.trigger(i.events.kbChange,[s,s.el])},p.delay/3))},p.showTyping&&s.options.alwaysOpen&&s.isVisible()?s.typing_setup():s.$el.unbind(i.events.kbBeforeVisible+s.typing_namespace).bind(i.events.kbBeforeVisible+s.typing_namespace,function(){p.showTyping?s.typing_setup():s.typing_setup_reset()}))})}});